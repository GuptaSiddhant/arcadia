{# Load Essentials #}
{% extends 'base.html' %}
{% load static %}
{% load arcadia_tags %}


{# Section : Header #}
{% block title %} Your Profile {% endblock %}
{% block meta %} {# empty MetaTags #} {% endblock %}


{# Section : Sidebar #}
{% block side_head %} Your Profile {% endblock %}
{% block side_body %}
    <div id="game-image"
         style="width: 100%; text-align: center; margin-bottom: 1rem">
        <img id="user_image" draggable="false" src="{{ user.image }}">
    </div>
    <div class="form-group">
        <label>Name:</label>
        {% if user.first_name == '' %}
            We don't know your name.
        {% else %}
            {{ user.first_name }} {{ user.last_name }}
        {% endif %}
    </div>
    <div class="form-group">
        <label>Username: {{ user.username }} </label>
        <span style="font-size: 0.8rem;">({{ user.email }})</span>
    </div>
    <div class="form-group">
        <label>Password:</label>
        <a href="{% url 'password_change' %}">Change</a>
    </div>
    <div class="form-group">
        <label>Account Type:</label>
        {% if user.is_dev == False %}
            Player
        {% else %}
            Developer
        {% endif %}
    </div>
{% endblock %}
{% block side_foot %}
    <button type="button" class="btn btn-outline-info btn-block"
            onclick="location.href='{% url 'profileEdit' %}'">
        Update Profile
    </button>
{% endblock %}


{# Section : Main #}
{% block main_head %}
    Welcome,
    {% if user.first_name == '' %} {{ user.username }}
    {% else %} {{ user.first_name }} {% endif %} !
{% endblock %}
{% block main_body %}
    <h5>You are a star!</h5> See your stats here.
{% endblock %}
{% block main_foot %}
    <button type="button" class="btn btn-danger btn-block" onclick="location.href='{% url 'logout' %}'">
        Logout
    </button>
{% endblock %}


{# Section : Extra Code #}
{% block extra %}
    {% if user.is_authenticated %}
        <div id="snackbar"></div>
    {% else %}
        {# Redirct to login #}
        <script type="text/javascript">
            window.location = "{% url 'login' %}?next={% firstof request.path '/' %}&redirect=access"
        </script>
    {% endif %}
{% endblock %}


{# Section : Logic #}
{% block logic %}
    <script>
        $(document).ready(function () {
            let params = (new URL(document.location)).searchParams;
            let redirect = params.get("redirect");

            if (redirect.includes('activate')) {
                var x = document.getElementById("snackbar");
                x.textContent = "Account activated!";
                x.className = "show";
                setTimeout(function () {
                    x.className = x.className.replace("show", "");
                }, 3000);
            }
        });

    </script>
 {% endblock %}
